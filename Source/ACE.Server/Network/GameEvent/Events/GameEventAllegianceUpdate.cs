using System;
using ACE.Server.Network.Structure;
using ACE.Server.Entity;

namespace ACE.Server.Network.GameEvent.Events
{
    public class GameEventAllegianceUpdate : GameEventMessage
    {
        /// <summary>
        /// Returns info related to a player's monarch, patron, and vassals.
        /// </summary>
        public GameEventAllegianceUpdate(Session session, Allegiance allegiance, AllegianceNode node)
            : base(GameEventType.AllegianceUpdate, GameMessageGroup.UIQueue, session)
        {
            // TODO

            // No Allegiance
            // 00000000000000000000000000000B00000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000803F00000000000000000000000000000000000000000000000000000000

            // Some small allegiances
            // 01000000020000000000000002000B00000000010000000000000000000000000000000000000000000000000000000092240000000000000000000000000000000000000000803F000000000000000000000000000000009B6C81580000000000000000D2A40F5050014E00000000000C000000020301002F00000032002D000000000000000000090048616C6C616E69656C00D2A40F50D3A40F5000000000BA94D5011D0000000107010035000000050000001B450300B2313D080600527573736574
            // 01000000020000000000000002000B00000000010000000000000000000000000000000000000000000000000000000092240000000000000000000000000000000000000000803F000000000000000000000000000000009C6C81580000000000000000D2A40F5050014E00000000000C000000020301002F00000032002D000000000000000000090048616C6C616E69656C00D2A40F50D3A40F5000000000BA94D5011D0000000107010035000000050000001B450300B2313D080600527573736574

            // 01000000030000000000000002000B00000000010000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000803F0000000000000000000000000000000053AF8F5800000000000000006401125000000000000000000C000000020102001100000032002D0000000000000000000700416D6F72696E61000000640112509601125000000000E12203001D000000010401000F00000032002D00C71F0000B37812000A004C6974746C652042656E
            // 01000000030000000000000002000B00000000010000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000803F0000000000000000000000000000000057AF8F5800000000000000006401125000000000000000000C000000020102001100000032002D0000000000000000000700416D6F72696E61000000640112509601125000000000E12203001D000000010401000F00000032002D00C71F0000B37812000A004C6974746C652042656E

            // 01000000020000000100000002000B0000000001000000000000000000000000000000000000000000000000000000006A190000000000000000000000000000000000000000803F00000000000000000000000000000000A6B690580000000000000000A235015000000000000000000D000000010201001D0000001E0005003A5E0000A01CAD170300486578000000A235015006C70850000000002B1B00001C000000020301000000000005000000144E000005A4D504040041797A610000
            // 01000000020000000100000002000B0000000001000000000000000000000000000000000000000000000000000000006A190000000000000000000000000000000000000000803F00000000000000000000000000000000ABB690580000000000000000A235015000000000000000000D000000010201001D0000001E0005003A5E0000A01CAD170300486578000000A235015006C70850000000002B1B00001C000000020301000000000005000000144E000005A4D504040041797A610000

            // 01000000020000000100000002000B0000000001000000000000000000000000000000000000000000000000000000004E260000000000000000000000000000000000000000803F00000000000000000000000000000000726B895800000000000000000A590F5000000000000000000D00000001050100170000000F0000000000000000000000050054756E7A69000A590F5009590F5000000000B82A06001D00000001010100140000000A000500C93B0000E3B90200070054696D74686F73000000
            // 01000000020000000100000002000B0000000001000000000000000000000000000000000000000000000000000000004E260000000000000000000000000000000000000000803F00000000000000000000000000000000776B895800000000000000000A590F5000000000000000000D00000001050100170000000F0000000000000000000000050054756E7A69000A590F5009590F5000000000B82A06001D00000001010100150000000A000500C93B0000E3B90200070054696D74686F73000000

            //Writer.Write(new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0B, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x3F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 });

            var startPos = Writer.BaseStream.Position;

            // uint - rank - this player's rank within their allegiance
            // AllegianceProfile - prof
            uint rank = (node == null) ? 0 : node.Rank;
            Console.WriteLine("Rank: " + rank);
            Writer.Write(rank);

            var prof = new AllegianceProfile(allegiance, node);
            Writer.Write(prof);

            var endPos = Writer.BaseStream.Position;

            var totalBytes = endPos - startPos;
            Console.WriteLine("Allegiance bytes written: " + totalBytes);
        }
    }
}
